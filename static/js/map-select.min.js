let tgt_reg="",tgt_count="",tgt_stat="",tgt_city="";var chart=am4core.create("map",am4maps.MapChart);chart.geodata=am4geodata_worldLow,chart.projection=new am4maps.projections.Miller;var polygonSeries=chart.series.push(new am4maps.MapPolygonSeries);polygonSeries.useGeodata=!0;var polygonTemplate=polygonSeries.mapPolygons.template;polygonTemplate.tooltipText="{name}",polygonTemplate.fill=am4core.color("#74B266"),polygonTemplate.stroke=am4core.color("rgba(0, 0, 0, .3)"),polygonTemplate.strokeWidth=.5,polygonTemplate.cursorOverStyle=am4core.MouseCursorStyle.pointer,polygonTemplate.events.on("hit",function(t){polygonSeries.mapPolygons.each(function(t){t.isActive=!1});var e=t.target;e.isActive=!0;var a=e.dataItem.dataContext.id;$("#target-country").attr("data-c-code",a),searchCountry(a)});var activeState=polygonTemplate.states.create("active");activeState.properties.fill=am4core.color("#FFA500");var hs=polygonTemplate.states.create("hover");function searchCountry(t){fetch("/static/utils/getCountryISO2.json").then(t=>t.json()).then(e=>{if(e.hasOwnProperty(t)){var a=e[t],o=a.region;let r=a.target;$("#target-region").val(o),$("#target-country").val(a.target),gsap.to("#region-sel",{duration:.5,text:o}),gsap.to("#country-sel",{duration:.5,text:r}),tgt_reg=o,tgt_count=r}else console.error(t+": 404 Not Found")}).catch(t=>console.error("Error fetching data:",t))}async function getStatesByCountry(t){try{let e=await fetch("..\\static\\place\\states.json"),a=await e.json(),o=a.filter(e=>e.country_name===t);return o}catch(r){return console.error("Error fetching states:",r),[]}}function manipulateStates(t){let e="";for(let a=0;a<t.length;a++){let o=t[a];e+=`<div class="state-box chFontGSP ${$("#theme-font").val()}">${o.name}</div>`}$("#state-dist").html(e)}async function findCities(t,e,a){try{let o=await fetch("..\\static\\place\\search_city.json"),r=await o.json(),i=r.filter(o=>o.country_name===t&&o.state_name===e&&o.country_code===a);return i}catch(n){return console.error("Error fetching or parsing city data:",n),[]}}function manipulateCities(t){let e="";for(let a=0;a<t.length;a++){let o=t[a];e+=`<div class="city-box chFontGSP ${$("#theme-font").val()}" lat="${o.latitude}" long="${o.longitude}">${o.name}</div>`}$("#city-dist").empty(),$("#city-dist").html(e)}hs.properties.fill=am4core.color("#367B25"),chart.zoomControl=new am4maps.ZoomControl,document.getElementById("reset-map").addEventListener("click",function(){polygonSeries.mapPolygons.each(function(t){t.isActive=!1}),chart.goHome(),gsap.to("#region-sel",{duration:.5,text:"Region"}),gsap.to("#country-sel",{duration:.5,text:"Country"}),gsap.to("#state-sel",{duration:.5,text:"State"}),gsap.to("#city-sel",{duration:.5,text:"City"}),gsap.to("#mapModalLabel",{duration:.5,text:"Select Country"}),gsap.to("#get-target-location",{duration:.5,text:"Select Country"}),$("#map").slideDown(500),$("#state-dist").slideUp(250),$("#city-dist").slideUp(250),$("#state-dist").empty().html('<span class="clue chFontGSP">Loading...</span>'),$("#city-dist").empty().html('<span class="clue chFontGSP">Loading...</span>'),$("#get-target-location").attr("data-puprus","country"),$("#get-target-location").attr("data-search","0"),$("#get-target-location").removeAttr("data-bs-dismiss","modal")}),$("#get-target-location").click(function(){if("country"==$(this).attr("data-puprus")){$("#map").slideUp(500),$("#state-dist").slideDown(250),$("#located-Region").text(tgt_reg),$("#located-Country").text(tgt_count),changeTippy("#located-Region",`Region: ${tgt_reg}`),changeTippy("#located-Country",`Country: ${tgt_count}`),gsap.to("#mapModalLabel",{duration:.5,text:"Select State"}),gsap.to("#get-target-location",{duration:.5,text:"Select State"}),$(this).attr("data-puprus","states");let t=$("#target-country").val();try{getStatesByCountry(t).then(t=>manipulateStates(t)).then(()=>{$(".state-box").click(function(){$(".state-box").removeClass("active"),$(this).addClass("active");let t=$(this).text();gsap.to("#state-sel",{duration:.5,text:t}),$("#located-State").text(t),changeTippy("#located-State",`State: ${t}`),$("#target-state").val(t),tgt_stat=t})}).catch(t=>console.error(t))}catch(e){console.error(e)}}else if("states"==$(this).attr("data-puprus")){$("#map").slideUp(500),$("#state-dist").slideUp(250),$("#city-dist").slideDown(250),$("#located-Region").text(tgt_reg),$("#located-Country").text(tgt_count),gsap.to("#mapModalLabel",{duration:.5,text:"Select City"}),gsap.to("#get-target-location",{duration:.5,text:"Get Weather"}),$(this).attr("data-puprus","cities");try{let a=$("#target-country").val(),o=$("#target-country").attr("data-c-code"),r=$("#target-state").val();findCities(a,r,o).then(t=>manipulateCities(t)).then(()=>{$(".city-box").click(function(){$(".city-box").removeClass("active"),$(this).addClass("active");let t=$(this).text();gsap.to("#city-sel",{duration:.5,text:t}),$("#located-city").text(t),changeTippy("#located-city",`City: ${t}`),$("#target-city").val(t),$("#target-location-long").val($(this).attr("long")),$("#target-location-lat").val($(this).attr("lat")),$("#get-target-location").attr("data-search","1"),$("#get-target-location").attr("data-bs-dismiss","modal"),tgt_city=t})}).catch(t=>console.error(t))}catch(i){console.error(i)}}else"cities"==$(this).attr("data-puprus")&&$(this).attr("data-puprus","search")});